{
    "dashboard": {
        "uid": "soroban-api",
        "title": "Soroban Registry â€” API Overview",
        "timezone": "utc",
        "refresh": "10s",
        "templating": {
            "list": [
                {
                    "name": "datasource",
                    "type": "datasource",
                    "query": "prometheus"
                }
            ]
        },
        "panels": [
            {
                "title": "Request Rate",
                "type": "timeseries",
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 0
                },
                "targets": [
                    {
                        "expr": "sum(rate(soroban_http_requests_total[5m])) by (method)",
                        "legendFormat": "{{method}}"
                    }
                ]
            },
            {
                "title": "Error Rate (%)",
                "type": "timeseries",
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 12,
                    "y": 0
                },
                "targets": [
                    {
                        "expr": "sum(rate(soroban_http_requests_total{status=~\"5..\"}[5m])) / sum(rate(soroban_http_requests_total[5m])) * 100",
                        "legendFormat": "5xx %"
                    }
                ]
            },
            {
                "title": "Latency P50 / P95 / P99",
                "type": "timeseries",
                "gridPos": {
                    "h": 8,
                    "w": 12,
                    "x": 0,
                    "y": 8
                },
                "targets": [
                    {
                        "expr": "histogram_quantile(0.50, sum(rate(soroban_http_request_duration_seconds_bucket[5m])) by (le))",
                        "legendFormat": "P50"
                    },
                    {
                        "expr": "histogram_quantile(0.95, sum(rate(soroban_http_request_duration_seconds_bucket[5m])) by (le))",
                        "legendFormat": "P95"
                    },
                    {
                        "expr": "histogram_quantile(0.99, sum(rate(soroban_http_request_duration_seconds_bucket[5m])) by (le))",
                        "legendFormat": "P99"
                    }
                ]
            },
            {
                "title": "In-Flight Requests",
                "type": "gauge",
                "gridPos": {
                    "h": 8,
                    "w": 6,
                    "x": 12,
                    "y": 8
                },
                "targets": [
                    {
                        "expr": "soroban_http_requests_in_flight",
                        "legendFormat": "in-flight"
                    }
                ]
            },
            {
                "title": "Requests by Path",
                "type": "table",
                "gridPos": {
                    "h": 8,
                    "w": 6,
                    "x": 18,
                    "y": 8
                },
                "targets": [
                    {
                        "expr": "sum(rate(soroban_http_requests_total[5m])) by (path)",
                        "legendFormat": "{{path}}",
                        "format": "table",
                        "instant": true
                    }
                ]
            }
        ]
    }
}