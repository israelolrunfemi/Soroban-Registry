#!/bin/sh
# Soroban Lint Pre-Commit Hook
# Installation:
#   cp templates/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit

set -e

CONTRACT_PATH="${SOROBAN_CONTRACT_PATH:-./contracts}"

echo "üîç Running soroban-registry lint..."

if [ ! -d "$CONTRACT_PATH" ]; then
    echo "‚ö†Ô∏è  Contract path not found: $CONTRACT_PATH"
    exit 0
fi

# Run linting
if soroban-registry lint "$CONTRACT_PATH" --level=error --format=human; then
    echo "‚úÖ Lint check passed!"
    exit 0
else
    EXIT_CODE=$?
    echo "‚ùå Lint errors found. Commit aborted."
    echo "   Fix errors or run: soroban-registry lint $CONTRACT_PATH --fix"
    exit "$EXIT_CODE"
fi
